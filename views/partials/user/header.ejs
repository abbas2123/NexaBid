<header class="bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700">
  <div class="max-w-[1800px] mx-auto px-4 sm:px-6 lg:px-10 xl:px-16">

    <div class="flex items-center justify-between h-16 sm:h-20">
      <div class="flex items-center space-x-8">

  <!-- Updated Logo -->
  <a href="/" class="flex items-center gap-2">
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <span class="text-[#111518] text-lg sm:text-xl font-bold leading-tight">
      NexaBid
    </span>
  </a>

  <!-- Desktop Nav -->
  <nav class="hidden md:flex items-center space-x-6 lg:space-x-8">
    <a class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-colors font-medium" href="/">Home</a>
    <a class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-colors font-medium" href="/tenders">Tenders</a>
    <a class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-colors font-medium" href="/properties">Properties</a>
    <a class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-colors font-medium" href="/contact">Contact Us</a>
  </nav>

</div>

      <!-- RIGHT: Search + Icons + Avatar + Mobile menu -->
      <div class="flex items-center space-x-3 sm:space-x-4">
        <!-- Search (hidden on very small screens) -->
        <div class="relative hidden sm:block">
          <span class="material-icons absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500">
            search
          </span>
          <input
           id="globalSearchInput"
            type="text"
            placeholder="Search"
            class="bg-gray-100 dark:bg-gray-800 border-none rounded-lg pl-10 pr-4 py-2 w-44 md:w-64 text-gray-700 dark:text-gray-300 focus:ring-2 focus:ring-primary focus:outline-none"
          />
          <div id="searchResultsBox"
       class="absolute left-0 top-12 w-full bg-white dark:bg-slate-800 shadow-lg rounded-lg 
              hidden max-h-80 overflow-y-auto z-50">
               </div>
        </div>
<script src="/js/search.js"></script>
        <!-- Chat Icon -->
        <button class="p-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700">
          <span class="material-icons text-gray-600 dark:text-gray-400">chat_bubble_outline</span>
        </button>

        <!-- Notifications Icon -->
       <!-- Notification Button -->
<button id="notificationBtn"
  class="relative p-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700"
>
  <span class="material-icons text-gray-600 dark:text-gray-400">notifications_none</span>

  <!-- Unread Count Badge -->
  <span id="notificationBadge"
      class="absolute -top-1 -right-1 bg-red-600 text-white text-xs px-1.5 py-0.5 rounded-full hidden">
</span>
</button>

<!-- Notification Modal -->
<div id="notificationModal"
     class="fixed inset-0 bg-black/40 backdrop-blur-sm hidden z-50 flex items-start justify-end p-4">

  <div class="w-full sm:w-96 bg-white dark:bg-gray-800 rounded-xl shadow-xl p-4 mt-16 animate-slide-down">

    <div class="flex justify-between items-center mb-3">

      <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
        Notifications
      </h2>

      <div class="flex items-center gap-3">

        <!-- Clear All (Mark as Read) -->
        <button id="markAllRead"
                class="text-xs px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 transition">
          Clear
        </button>

        <!-- Close Modal -->
        <button id="closeNotification"
                class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
          <span class="material-icons">close</span>
        </button>
      </div>

    </div>

    <!-- Notifications List -->
    <div id="notificationsList"
         class="space-y-3 max-h-64 overflow-y-auto"></div>

    <!-- Empty State -->
    <div id="noNotifications"
         class="py-6 text-center text-gray-500 dark:text-gray-400 hidden">
      No notifications yet.
    </div>

  </div>
</div>

<style>
  @keyframes slideDown {
    0% { transform: translateY(-10px); opacity: 0; }
    100% { transform: translateY(0); opacity: 1; }
  }
  .animate-slide-down { animation: slideDown 0.25s ease-out; }
</style>
        <!-- User Avatar or Login -->
        <% if (user) { %>
  <a href="/user/profile" 
   class="flex items-center justify-center h-10 w-10 rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 transition">
  <span class="material-icons text-lg">person</span>
</a>
<% } else { %>
  <a href="/auth/login" class="text-sm sm:text-base font-semibold text-primary">
    Login
  </a>
<% } %>

        <!-- Mobile Menu Button -->
        <button id="menu-btn" class="md:hidden p-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700">
          <span class="material-icons text-gray-600 dark:text-gray-300">menu</span>
        </button>
      </div>
    </div>

    <!-- Mobile Nav -->
    <div id="mobile-menu" class="md:hidden hidden pb-4 space-y-2">
      <a href="/" class="block text-gray-700 dark:text-gray-200 font-medium">Home</a>
      <a href="/tenders" class="block text-gray-700 dark:text-gray-200 font-medium">Tenders</a>
      <a href="/properties" class="block text-gray-700 dark:text-gray-200 font-medium">Properties</a>
      <a href="/contact" class="block text-gray-700 dark:text-gray-200 font-medium">Contact Us</a>
    </div>
  </div>
</header>

<script>
  document.getElementById("menu-btn")?.addEventListener("click", () => {
    const menu = document.getElementById("mobile-menu");
    if (menu) menu.classList.toggle("hidden");
  });
</script>

<script>
  const btn = document.getElementById("notificationBtn");
  const modal = document.getElementById("notificationModal");
  const closeBtn = document.getElementById("closeNotification");

  btn.addEventListener("click", () => {
    modal.classList.remove("hidden");
  });

  closeBtn.addEventListener("click", () => {
    modal.classList.add("hidden");
  });

  // Click Outside Close
  modal.addEventListener("click", (e) => {
    if (e.target === modal) {
      modal.classList.add("hidden");
    }
  });
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {

  const clearBtn = document.getElementById("markAllRead");
  const list = document.getElementById("notificationsList");
  const emptyMsg = document.getElementById("noNotifications");
  const badge = document.getElementById("notificationBadge");

  if (clearBtn) {
    clearBtn.addEventListener("click", async () => {
      try {
        const res = await fetch("/notifications/mark-read", {
          method: "POST",
          headers: { "Content-Type": "application/json" }
        });

        if (res.ok) {
          // Clear UI instantly
          list.innerHTML = "";
          emptyMsg.classList.remove("hidden");
          badge.classList.add("hidden");

          console.log("Notifications cleared");
        }
      } catch (err) {
        console.error("Clear notifications failed", err);
      }
    });
  }

});
</script>
