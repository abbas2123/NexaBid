<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title><%= title || "Sign Up - NexaBid" %></title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>

<!-- Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>

<script>
tailwind.config = {
  darkMode: "class",
  theme: {
    extend: {
      colors: {
        primary: "#007bff",
        "background-light": "#ffffff",
        "background-dark": "#111827",
        "surface-light": "#f3f4f6",
        "surface-dark": "#1f2937",
        "text-light-primary": "#111827",
        "text-dark-primary": "#f9fafb",
      },
      fontFamily: { display: ["Inter", "sans-serif"] },
      borderRadius: { DEFAULT: "0.5rem" },
    },
  },
};
</script>

<style>
body { font-family: 'Inter', sans-serif; }
</style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-text-light-primary dark:text-text-dark-primary">

<!-- Header -->
<header class="bg-background-light dark:bg-background-dark border-b border-surface-light dark:border-surface-dark">
<nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">

  <div class="text-2xl font-bold">NexaBid</div>

  <!-- Hamburger Menu -->
  <button id="menu-toggle" class="md:hidden text-2xl text-gray-600 dark:text-gray-300">‚ò∞</button>

  <!-- Desktop Menu -->
  <div class="hidden md:flex items-center space-x-8">
    <a href="/" class="hover:text-primary transition">Home</a>
    <a href="/about" class="hover:text-primary transition">About</a>
    <a href="/contact" class="hover:text-primary transition">Contact</a>
    <a href="/auth/login" class="px-4 py-2 bg-surface-light dark:bg-surface-dark rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition text-gray-800 dark:text-gray-200">
      Sign in
    </a>
  </div>
</nav>

<!-- Mobile Menu -->
<div id="mobile-menu" class="hidden md:hidden px-4 py-3 space-y-3 text-center bg-surface-light dark:bg-surface-dark">
  <a href="/" class="block hover:text-primary py-1">Home</a>
  <a href="/about" class="block hover:text-primary py-1">About</a>
  <a href="/contact" class="block hover:text-primary py-1">Contact</a>
  <a href="/auth/login" class="block py-2 bg-primary text-white rounded-lg hover:bg-blue-600">Sign in</a>
</div>
</header>

<!-- Signup Form -->
<main class="flex-grow flex items-center justify-center px-4 py-10">
<div class="w-full max-w-md p-6 sm:p-8 rounded-xl shadow-lg bg-background-light dark:bg-background-dark">

<h2 class="text-center text-3xl font-bold mb-6">WELCOME TO NexaBid</h2>

<form id="signupForm" class="space-y-5">

  <div>
    <label class="block text-sm font-medium mb-1">Full Name</label>
    <input type="text" id="name" required placeholder="Enter your full name"
    class="w-full px-3 py-3 border rounded-lg"/>
  </div>

  <div>
    <label class="block text-sm font-medium mb-1">Email</label>
    <input type="email" id="email" required placeholder="Enter your email"
    class="w-full px-3 py-3 border rounded-lg"/>
  </div>

  <div>
    <label class="block text-sm font-medium mb-1">Phone Number</label>
    <input type="tel" id="phone" required placeholder="Enter your phone number"
    class="w-full px-3 py-3 border rounded-lg"/>
  </div>

  <div>
    <label class="block text-sm font-medium mb-1">Password</label>
    <div class="relative">
      <input type="password" id="password" required placeholder="Enter your password"
      class="w-full px-3 py-3 pr-12 border rounded-lg"/>
      <span id="togglePassword"
        class="absolute inset-y-0 right-3 flex items-center cursor-pointer text-gray-500">üëÅÔ∏è</span>
    </div>
  </div>

  <button type="submit"
  class="w-full py-3 bg-primary text-white rounded-lg hover:bg-blue-600 transition">Sign up</button>

  <div class="flex items-center">
    <div class="flex-grow border-t"></div>
    <span class="mx-2 text-gray-500 text-sm">Or</span>
    <div class="flex-grow border-t"></div>
  </div>

  <a href="/auth/google"
  class="flex items-center justify-center w-full py-3 border rounded-lg hover:bg-gray-200 transition">
    <svg class="h-5 w-5 mr-2"><!-- Google icon here --></svg>
    Sign up with Google
  </a>

  <p class="text-center text-sm mt-4">
    Already have an account?
    <a href="/auth/login" class="text-primary font-medium hover:text-blue-600">Log in</a>
  </p>

</form>

</div>
</main>

<!-- SweetAlert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  // Mobile Menu Toggle
  document.getElementById("menu-toggle").addEventListener("click", () =>
    document.getElementById("mobile-menu").classList.toggle("hidden")
  );

  // Password Visibility Toggle
  const passwordInput = document.getElementById("password");
  const toggleBtn = document.getElementById("togglePassword");

  toggleBtn.addEventListener("click", () => {
    passwordInput.type = passwordInput.type === "password" ? "text" : "password";
    toggleBtn.textContent = passwordInput.type === "password" ? "üëÅÔ∏è" : "üôà";
  });

  // Form Submit + Validation
  document.getElementById("signupForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const password = document.getElementById("password").value.trim();

    // Client validation
    if (!name || name.length < 3)
      return Swal.fire("Invalid Name", "Enter a valid full name", "warning");

    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email))
      return Swal.fire("Invalid Email", "Enter a valid email address", "warning");

    if (!/^[0-9]{10}$/.test(phone))
      return Swal.fire("Invalid Phone", "Enter a valid 10-digit phone number", "warning");

    if (password.length < 6)
      return Swal.fire("Weak Password", "Minimum 6 characters required", "warning");

    const userData = { name, email, phone, password };

    try {
      const res = await fetch("/auth/signup", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(userData),
      });

      const data = await res.json();

      if (!data.success) {
        return Swal.fire("Signup Failed", data.message, "error");
      }

      Swal.fire({
        icon: "success",
        title: "Signup Successful üéâ",
        text: "Please Verify OTP",
        // timer: 1500,
        showConfirmButton: false,
      });

      setTimeout(() => window.location.href = `/auth/verify-otp?userId=${data.user.id}`,2000);

    } catch (err) {
      Swal.fire("Error", "Server not responding, try again!", "error");
    }
  });
});
</script>

</body>
</html>